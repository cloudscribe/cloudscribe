(function(n){"use strict";typeof define=="function"&&define.amd?define(["jquery","load-image","load-image-meta","load-image-exif","canvas-to-blob","./jquery.fileupload-process"],n):typeof exports=="object"?n(require("jquery"),require("blueimp-load-image/js/load-image"),require("blueimp-load-image/js/load-image-meta"),require("blueimp-load-image/js/load-image-exif"),require("blueimp-canvas-to-blob"),require("./jquery.fileupload-process")):n(window.jQuery,window.loadImage)})(function(n,t){"use strict";n.blueimp.fileupload.prototype.options.processQueue.unshift({action:"loadImageMetaData",disableImageHead:"@",disableExif:"@",disableExifThumbnail:"@",disableExifSub:"@",disableExifGps:"@",disabled:"@disableImageMetaDataLoad"},{action:"loadImage",prefix:!0,fileTypes:"@",maxFileSize:"@",noRevoke:"@",disabled:"@disableImageLoad"},{action:"resizeImage",prefix:"image",maxWidth:"@",maxHeight:"@",minWidth:"@",minHeight:"@",crop:"@",orientation:"@",forceResize:"@",disabled:"@disableImageResize"},{action:"saveImage",quality:"@imageQuality",type:"@imageType",disabled:"@disableImageResize"},{action:"saveImageMetaData",disabled:"@disableImageMetaDataSave"},{action:"resizeImage",prefix:"preview",maxWidth:"@",maxHeight:"@",minWidth:"@",minHeight:"@",crop:"@",orientation:"@",thumbnail:"@",canvas:"@",disabled:"@disableImagePreview"},{action:"setImage",name:"@imagePreviewName",disabled:"@disableImagePreview"},{action:"deleteImageReferences",disabled:"@disableImageReferencesDeletion"});n.widget("blueimp.fileupload",n.blueimp.fileupload,{options:{loadImageFileTypes:/^image\/(gif|jpeg|png|svg\+xml)$/,loadImageMaxFileSize:1e7,imageMaxWidth:1920,imageMaxHeight:1080,imageOrientation:!1,imageCrop:!1,disableImageResize:!0,previewMaxWidth:80,previewMaxHeight:80,previewOrientation:!0,previewThumbnail:!0,previewCrop:!1,previewCanvas:!0},processActions:{loadImage:function(i,r){if(r.disabled)return i;var e=this,u=i.files[i.index],f=n.Deferred();return n.type(r.maxFileSize)==="number"&&u.size>r.maxFileSize||r.fileTypes&&!r.fileTypes.test(u.type)||!t(u,function(n){n.src&&(i.img=n);f.resolveWith(e,[i])},r)?i:f.promise()},resizeImage:function(i,r){if(r.disabled||!(i.canvas||i.img))return i;r=n.extend({canvas:!0},r);var s=this,f=n.Deferred(),u=r.canvas&&i.canvas||i.img,o=function(n){n&&(n.width!==u.width||n.height!==u.height||r.forceResize)&&(i[n.getContext?"canvas":"img"]=n);i.preview=n;f.resolveWith(s,[i])},e;if(i.exif){if(r.orientation===!0&&(r.orientation=i.exif.get("Orientation")),r.thumbnail&&(e=i.exif.get("Thumbnail"),e))return t(e,o,r),f.promise();i.orientation?delete r.orientation:i.orientation=r.orientation}return u?(o(t.scale(u,r)),f.promise()):i},saveImage:function(t,i){if(!t.canvas||i.disabled)return t;var f=this,r=t.files[t.index],u=n.Deferred();if(t.canvas.toBlob)t.canvas.toBlob(function(n){n.name||(r.type===n.type?n.name=r.name:r.name&&(n.name=r.name.replace(/\.\w+$/,"."+n.type.substr(6))));r.type!==n.type&&delete t.imageHead;t.files[t.index]=n;u.resolveWith(f,[t])},i.type||r.type,i.quality);else return t;return u.promise()},loadImageMetaData:function(i,r){if(r.disabled)return i;var f=this,u=n.Deferred();return t.parseMetaData(i.files[i.index],function(t){n.extend(i,t);u.resolveWith(f,[i])},r),u.promise()},saveImageMetaData:function(n,t){if(!(n.imageHead&&n.canvas&&n.canvas.toBlob&&!t.disabled))return n;var i=n.files[n.index],r=new Blob([n.imageHead,this._blobSlice.call(i,20)],{type:i.type});return r.name=i.name,n.files[n.index]=r,n},setImage:function(n,t){return n.preview&&!t.disabled&&(n.files[n.index][t.name||"preview"]=n.preview),n},deleteImageReferences:function(n,t){return t.disabled||(delete n.img,delete n.canvas,delete n.preview,delete n.imageHead),n}}})});